&star_job

    history_columns_file = 'history_columns.list'
    profile_columns_file = 'profile_columns.list'

    echo_at_start = ''
    echo_at_end = ''

    show_retry_counts_when_terminate = .true.
    show_timestep_limit_counts_when_terminate = .true. 

    show_log_description_at_start = .false. 
    show_net_reactions_info = .true. 


    change_net = .true. 
    new_net_name = 'mesa_30.net'
    dump_missing_metals_into_heaviest = .true. 
    
    ! Weak reactions
    T9_weaklib_full_off = 0.0001d0
    T9_weaklib_full_on = 0.00011d0

    ! Hydrodynamics 
    change_v_flag = .true. ! Radial velocity
    new_v_flag = .true.

    show_retry_counts_when_terminate = .true.
    show_timestep_limit_counts_when_terminate = .true.

    pgstar_flag = .true.
    save_pgstar_files_when_terminate = .true.

/

&eos      
      use_Skye = .true.
      use_PC = .false.
/

&kap      
      
/

&controls

    ! Asteroseismology

    write_pulse_data_with_profile = .true.
    add_atmosphere_to_pulse_data = .true.
    pulse_data_format = 'GYRE'
    keep_surface_point_for_pulse_data = .true.
    interpolate_rho_for_pulse_data = .true.
    add_center_point_to_pulse_data = .true.

    ! Winds

    max_T_center_for_any_mass_loss = 1.1d9
    max_tries_for_implicit_wind = 10

    ! Atmosphere

    Pextra_factor = 1.5

    atm_option = 'T_tau'
    atm_T_tau_relation = 'Eddington'
    atm_T_tau_opacity = 'iterated'

    ! MLT

    mixing_length_alpha = 2
    MLT_option = 'TDC'

    use_Ledoux_criterion = .true.
    semiconvection_option = 'Langer_85 mixing; gradT = gradr'
    thermohaline_option = 'Kippenhahn'

    alpha_semiconvection = 1d-1
    thermohaline_coeff = 0 ! 2 up until He depletion

    mlt_make_surface_no_mixing = .true.

    ! Prevent radial pulses during advanced stages of burning
    use_drag_energy = .false. ! Remove energy from drag
    
    ! Extra term to the momentum equation
    
    drag_coefficient = 0.8d0
    min_q_for_drag = 0.8d0


    ! Superadiabatic convection routines
    
    use_superad_reduction = .false.
    superad_reduction_Gamma_limit = 0.3d0 ! Default is 0.5d0
    superad_reduction_Gamma_limit_scale = 5d0
    superad_reduction_Gamma_inv_scale = 5d0
    superad_reduction_diff_grads_limit = 1d-2 ! Default is 1d-3
    superad_reduction_limit = -1d0


    ! MLT ++, explicit, well tested

    okay_to_reduce_gradT_excess = .false.
    gradT_excess_f1 = 1d-4
    gradT_excess_f2 = 1d-2
    !gradT_excess_lambda1 = -1d0 ! Full on

    ! Mixing

    D_omega_mixing_rate = 1d0
    D_omega_mixing_across_convection_boundary = .false.
    
    ! Overshooting

    ! Step overshooting in H core
    overshoot_scheme(1) = 'step'
    overshoot_zone_type(1) = 'burn_H'
    overshoot_zone_loc(1) = 'any'
    overshoot_bdy_loc(1) = 'any'
    overshoot_f(1) = 0.11 !0.345 ! for M>10
    !overshoot_f(1) = 0.21 ! For M<10 
    overshoot_f0(1) = 0.01

    ! Exponential in the H core
    overshoot_scheme(2) = 'step' !'exponential'
    overshoot_zone_type(2) = 'burn_He'
    overshoot_zone_loc(2) = 'any'
    overshoot_bdy_loc(2) = 'any'
    overshoot_f(2) = 0.06 ! test ~0.11
    overshoot_f0(2) = 0.01

    ! We don't want to deal with He/CO core mergers 
    ! and there is reason to believe there is little
    ! inward overshooting in the shell across compositions boundaries
    ! overshoot_scheme(3) = 'none'
    ! overshoot_zone_type(3) = 'burn_He'
    ! overshoot_zone_loc(3) = 'shell'
    ! overshoot_bdy_loc(3) = 'bottom'

    ! A small amount of overshooting on top of any other convective core
    ! Avoid spurious numerical behavior
    ! Perfect amount for degenerate flames
    overshoot_scheme(3) = 'exponential'
    overshoot_zone_type(3) = 'any'
    overshoot_zone_loc(3) = 'any'
    overshoot_bdy_loc(3) = 'any'
    overshoot_f(3) = 0.005d0
    overshoot_f0(3) = 0.001d0

    ! Element Diffusion
    
    do_element_diffusion = .true.
    diffusion_use_isolve = .true. 
    diffusion_use_full_net = .false.
    diffusion_use_cgs_solver = .true.

    diffusion_num_classes = 11
    diffusion_class_representative(1) = 'h1'
    diffusion_class_representative(2) = 'he3'
    diffusion_class_representative(3) = 'he4'
    diffusion_class_representative(4) = 'c12'
    diffusion_class_representative(5) = 'n14'
    diffusion_class_representative(6) = 'o16'
    diffusion_class_representative(7) = 'ne20'
    diffusion_class_representative(8) = 'ne22'
    diffusion_class_representative(9) = 'mg24'
    diffusion_class_representative(10) = 'si28'
    diffusion_class_representative(11) = 'fe56'
    diffusion_class_A_max(1)  = 2
    diffusion_class_A_max(2)  = 3
    diffusion_class_A_max(3)  = 4
    diffusion_class_A_max(4)  = 12
    diffusion_class_A_max(5)  = 14
    diffusion_class_A_max(6)  = 16
    diffusion_class_A_max(7)  = 20
    diffusion_class_A_max(8)  = 22
    diffusion_class_A_max(9)  = 24
    diffusion_class_A_max(10) = 28
    diffusion_class_A_max(11) = 10000
    diffusion_class_factor(1)  = 1.0d0
    diffusion_class_factor(2)  = 1.0d0
    diffusion_class_factor(3)  = 1.0d0
    diffusion_class_factor(4)  = 1.0d0
    diffusion_class_factor(5)  = 1.0d0
    diffusion_class_factor(6)  = 1.0d0
    diffusion_class_factor(7)  = 1.0d0
    diffusion_class_factor(8)  = 1.0d0
    diffusion_class_factor(9)  = 1.0d0
    diffusion_class_factor(10) = 1.0d0
    diffusion_class_factor(11) = 1.0d0

    
    ! Timesteps

    time_delta_coeff = 1.0 ! decrease = resolution
    varcontrol_target   = 1d-3 ! decrease = resolution; residuals between two timesteps 
      
    min_timestep_factor = 0.8d0
    max_timestep_factor = 1.05d0
    timestep_factor_for_retries = 0.75
      
    min_timestep_limit = 1d-20 ! (seconds) ! 1d-12 is normal, 20 for sticky situations.

    limit_for_rel_error_in_energy_conservation = 1d-7
    hard_limit_for_rel_error_in_energy_conservation = 1d-6      
      
    never_skip_hard_limits = .true.
    min_xa_hard_limit = -1d-5
    min_xa_hard_limit_for_highT = -3d-5

    delta_lgTeff_limit =  1d-3
    delta_lgL_limit = 1d-3

    ! Time step resolution when the star goes off the MS
    
    delta_lgL_He_limit = 1d-3

    ! Recommend decreasing all three Rho, T, Tmax 
    ! to 1d-3 or lower in production runs
    delta_lgRho_cntr_limit = 1d-3 !0.03 ! 1d-3
    delta_lgRho_cntr_hard_limit = 0.1
    delta_lgRho_limit = 0.1 
      
    delta_lgT_cntr_limit_only_after_near_zams = .true.
    delta_lgT_cntr_limit = 1d-3 !0.002  ! 1d-3
    delta_lgT_cntr_hard_limit = 0.1 

    delta_lgT_max_limit_only_after_near_zams = .true.
    delta_lgT_max_limit = 1d-3 !0.002   ! 1d-3  
    delta_lgT_max_hard_limit = 0.1

    dX_div_X_limit(2) = -1 ! for he4

    ! On the changes in total abundance of each isotope
    ! one of the most useful timestep controls, period 
    dX_nuc_drop_limit = 1d-3 !2d-2 ! Recommend decreasing to 1d-3 or lower in a production run
    dX_nuc_drop_limit_at_high_T = 1d-2 !2d-2  ! default = -1 = same as dX_nuc_drop_limit
    dX_nuc_drop_min_X_limit = 1d-3 !1d-3 ! try decreasing to 1d-4 or 1d-5 in a production run
    dX_nuc_drop_max_A_limit = 70   ! try increasing beyond 60 in a big network run
    dX_nuc_drop_hard_limit = 1d99

     
    ! Time step controls below are useful for resolution on fuel depletion
    ! Notice how we set hard limits to -1, to ignore.
    delta_lg_XH_cntr_limit = 0.01d0
    delta_lg_XH_cntr_max   = 0.0d0
    delta_lg_XH_cntr_min   = -2.0d0
    delta_lg_XH_cntr_hard_limit = -1 !0.02d0
      
    delta_lg_XHe_cntr_limit = 0.01d0
    delta_lg_XHe_cntr_max   = 0.0d0
    delta_lg_XHe_cntr_min   = -2.0d0
    delta_lg_XHe_cntr_hard_limit = -1!0.02d0
      
    ! On ye        
    delta_Ye_highT_limit = 1d-3

    ! Mesh
    max_dq= 1d-3 ! or lower
    mesh_delta_coeff = 1d0 ! decrease 
    mesh_delta_coeff_for_highT = 1d0 
    logT_max_for_standard_mesh_delta_coeff = 9.0 
    logT_min_for_highT_mesh_delta_coeff = 9.5 
    
    !remesh_dt_limit = 1728000 ! 20 days. turn off remesh when dt smaller than this

    ! Solver
    ! Damped Newton and structure only
    scale_max_correction = 0.1d0
    ignore_species_in_max_correction = .true.

    use_gold2_tolerances = .false. 
    use_gold_tolerances = .true.

    max_abs_rel_run_E_err = 1d-2

    energy_eqn_option = 'dedt'

    convergence_ignore_equL_residuals = .true. 
    make_gradr_sticky_in_solver_iters = .true.
    
    xa_scale = 1d-5
    iter_for_resid_tol2 = 10

    warn_rates_for_high_temp = .true.
    max_safe_logT_for_rates = 10.5d0

    when_to_stop_rtol = 1d-3
    when_to_stop_atol = 1d-3

    ! Output

    terminal_show_log_dt = .false.

    !max_model_number = 4000000 ! if you're serious

    photo_interval         = 200
    photo_digits           = 8
    profile_interval       = 100 
    max_num_profile_models = 400000
    history_interval       = 1
    write_header_frequency = 10
    terminal_interval      = 10

    report_solver_progress = .true. ! Set true to see info about solver iterations
    report_ierr = .false. ! If true, produce terminal output when have some internal error


/

&pgstar

    !pause = .true.

/
